

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- main javascript -->
    <script src="/src/javascript.js"></script>
    <!-- Style sheet -->
    <link rel="stylesheet" href="/src/style/style.css">
</head>
<body style="text-align:center;">
    <div class="header">
        <!-- <script src="/like_button.js" type="text/babel"></script> -->
    </div>

    <div class="body-container">
        <!-- Recgonizer connection -->
        <div class="recognizer-container">
            <div class="recognizer" style="text-align:center;">
                <div>Teachable Machine Audio Model</div>
                <div id="label-container"></div>
                <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
                <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/speech-commands@0.4.0/dist/speech-commands.min.js"></script>
                
                <script type="text/javascript">
                    // more documentation available at
                    // https://github.com/tensorflow/tfjs-models/tree/master/speech-commands
                
                    // the link to your model provided by Teachable Machine export panel
                    const URL = "https://teachablemachine.withgoogle.com/models/axkQR8KxZ/";
                
                    async function createModel() {
                        const checkpointURL = URL + "model.json"; // model topology
                        const metadataURL = URL + "metadata.json"; // model metadata
                
                        const recognizer = speechCommands.create(
                            "BROWSER_FFT", // fourier transform type, not useful to change
                            undefined, // speech commands vocabulary feature, not useful for your models
                            checkpointURL,
                            metadataURL);
                
                        // check that model and metadata are loaded via HTTPS requests.
                        await recognizer.ensureModelLoaded();
                
                        return recognizer;
                    }
                
                    async function init() {
                        const recognizer = await createModel();
                        const classLabels = recognizer.wordLabels(); // get class labels
                        const labelContainer = document.getElementById("label-container");
                        for (let i = 0; i < classLabels.length; i++) {
                            labelContainer.appendChild(document.createElement("div"));
                        }
                
                        // listen() takes two arguments:
                        // 1. A callback function that is invoked anytime a word is recognized.
                        // 2. A configuration object with adjustable fields
                        recognizer.listen(result => {
                            const scores = result.scores; // probability of prediction for each class
                            // render the probability scores per class
                            for (let i = 0; i < classLabels.length; i++) {
                                const classPrediction = classLabels[i] + ": " + result.scores[i].toFixed(2);
                                labelContainer.childNodes[i].innerHTML = classPrediction;
                            }
                        }, {
                            includeSpectrogram: true, // in case listen should return result.spectrogram
                            probabilityThreshold: 0.75,
                            invokeCallbackOnNoiseAndUnknown: true,
                            overlapFactor: 0.50 // probably want between 0.5 and 0.75. More info in README
                        });
                
                        // Stop the recognition in 5 seconds.
                        // setTimeout(() => recognizer.stopListening(), 5000);
                    }
                </script>        
            </div>
            <div class="timer" style="display:none;"></div>
            <div class="btn">Go</div>    
        </div>
        <div class="button-container"></div>

        <div class="wheel-chart-container"></div>
        <div class="Percentage-chart-container"></div>
    </div>

    <div class="bottom-container"></div>
</body>

<!-- Load react -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script async src="https://ga.jspm.io/npm:es-module-shims@1.7.0/dist/es-module-shims.js"></script>
<script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react?dev",
        "react-dom/client": "https://esm.sh/react-dom/client?dev"
      }
    }
</script>
<script type="text/babel" data-type="module">
    import React, { StrictMode } from 'react';
    import { createRoot } from 'react-dom/client';
    import { useState, useEffect } from 'react';
    import { Component } from 'react';

    function HeaderTitle() {
        const styleHeader = {
            color: 'rgb(142, 142, 142)',
            fontSize: 50,
            lineHeight: '250%',
        }

        return (
            <>
              <span style={styleHeader} className="header-title">Sound Classifier</span>
            </>
          );
    }


    function GoButton() {
        let styleBtn = {
            fontSize: '30vmin',
            lineHeight: '200%',
        }

        function handleClick() {
            const element = document.querySelector('.timer')
            //inistialise
            let timer = 0
            element.style.display = 'block'
            element.innerHTML = timer

            //Trigger recognizer
            init()

            //Timing
            setInterval(() => {
                timer += 1
                console.log(timer)
                element.innerHTML = timer
            }, 1000)
        }

        return (
            <>
                <div style={styleBtn} className="Go-Btn" onClick={handleClick}>Go Btn</div>
            </>
        )
    }


    const buttonContainer = createRoot(document.querySelector('.button-container'));
    buttonContainer.render(<GoButton />)
    // Render your React component instead
    const root = createRoot(document.querySelector('.header'));
    root.render(<HeaderTitle />)


</script>



</html>